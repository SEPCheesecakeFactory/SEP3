@using Microsoft.AspNetCore.Components.Authorization

<div class="d-flex align-items-center mb-@(BottomMargin) pt-2">
    <a href="/" class="btn btn-link text-secondary p-0 me-4">
        <i class="fas fa-times fa-2x"></i>
    </a>

    <div class="w-100">
        <div class="progress" style="height: 16px;">
            <div class="progress-bar" style="width: @(GetPercentage(CurrentStep))%"></div>
        </div>
        @if (ShowProgressText)
        {
            <div class="text-end text-muted mt-1 small">
                Current Course Progress: @(GetPercentage(SavedProgress))%
            </div>
        }
    </div>
</div>

@code {
    [Parameter] public int CurrentStep { get; set; }
    [Parameter] public int TotalSteps { get; set; } = 1;
    [Parameter] public int SavedProgress { get; set; } = 1;
    [Parameter] public bool ShowProgressText { get; set; } = true;
    [Parameter] public int BottomMargin { get; set; } = 5;

    private int GetPercentage(int stepValue)
    {
        if (TotalSteps <= 0) return 0;
        
        double adjustedStep = Math.Max(0, stepValue - 1);
        double pct = adjustedStep / TotalSteps * 100;
        
        return (int)Math.Min(Math.Round(pct), 100);
    }
}
